Version 4
SHEET 1 1844 680
WIRE 688 -80 624 -80
WIRE 688 -64 688 -80
WIRE 720 -64 688 -64
WIRE 720 -48 704 -48
WIRE 704 -32 704 -48
WIRE 912 -32 784 -32
WIRE 624 32 624 0
WIRE 912 80 912 48
WIRE 272 144 -16 144
WIRE 464 144 272 144
WIRE 576 144 464 144
WIRE 688 144 656 144
WIRE 832 144 832 112
WIRE 272 224 272 208
WIRE 272 224 -16 224
WIRE 464 224 272 224
WIRE 608 224 464 224
WIRE 656 224 608 224
WIRE 832 256 832 224
WIRE 608 288 608 224
WIRE -192 304 -256 304
WIRE 16 304 -32 304
WIRE -192 320 -192 304
WIRE 16 320 16 304
WIRE 16 416 16 400
WIRE -192 432 -192 400
FLAG 688 144 v+
FLAG 656 224 v-
FLAG 16 416 0
FLAG -32 304 illu
FLAG 608 288 0
FLAG -256 304 illu
FLAG -192 432 0
FLAG 832 112 v+
FLAG 832 256 0
FLAG 624 32 0
FLAG 704 -32 0
FLAG 912 80 0
SYMBOL diode 256 144 R0
SYMATTR InstName D1
SYMATTR Value SolarDiode
SYMBOL res 448 128 R0
SYMATTR InstName R1
SYMATTR Value {Rsh}
SYMBOL res 672 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rs}
SYMBOL bi2 -16 144 R0
SYMATTR InstName B1
SYMATTR Value I=v(illu)/1000*Iph
SYMBOL res 0 304 R0
SYMATTR InstName R3
SYMATTR Value 100Meg
SYMBOL voltage -192 304 R0
SYMATTR InstName V1
SYMATTR Value 1000
SYMBOL current 832 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 108 Left 2
SYMATTR SpiceLine load
SYMATTR InstName I1
SYMATTR Value PULSE(0 1 0 1 1)
SYMBOL AutoGenerated\\testcell1 752 -48 R0
SYMATTR InstName U1
SYMBOL current 624 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 28 Left 2
SYMATTR InstName I2
SYMATTR Value PULSE(0 1 0 1 1)
SYMATTR SpiceLine load
SYMBOL voltage 912 -48 R0
SYMATTR InstName V2
SYMATTR Value 1000
TEXT 40 72 Left 2 !.model solardiode d(is=io n=a_n tref=temp)
TEXT 40 40 Left 2 !.param rs=1 rsh=10k iph=1 io=1e-6 a_n=10
TEXT 40 8 Left 2 !.tran 1
TEXT 1184 40 Left 2 !.subckt testcell1 1 2 3\nxu1 1 2 3 PVBasic rs=1 rsh=10k iph=1 io=1e-06 a_n=10\n.end\n*\n \n\n \n.subckt PVBasic v+ v- illu\nD1 N001 0 SolarDiode\nR1 N001 0 {Rsh}\nR2 v+ N001 {Rs}\nB1 0 N001 I=v(illu)/1000*Iph\nR3 illu 0 100Meg\n.model solardiode d(is=io n=a_n tref=temp)\n.end
